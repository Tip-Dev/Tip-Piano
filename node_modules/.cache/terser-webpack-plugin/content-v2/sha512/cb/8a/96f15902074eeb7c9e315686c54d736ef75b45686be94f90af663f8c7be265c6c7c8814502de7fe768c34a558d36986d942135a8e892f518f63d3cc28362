{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{124:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=n(125),a=new i.PlaneGeometry(1,1,1),r=new i.MeshBasicMaterial({color:2078700,side:i.DoubleSide}),s=new i.MeshBasicMaterial({color:16758569,side:i.DoubleSide});window.zero=new i.Vector3(0,0,0);var l=new(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._element=document.createElement(\"div\"),this._element.id=\"roll\",this._camera=new i.OrthographicCamera(0,1,1,0,1,1e3),this._camera.position.z=1,this._camera.lookAt(new i.Vector3(0,0,0)),this._scene=new i.Scene,this._renderer=new i.WebGLRenderer({alpha:!0}),this._renderer.setClearColor(0,0),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.sortObjects=!1,this._element.appendChild(this._renderer.domElement),this._currentNotes={},window.camera=this._camera,this._lastUpdate=Date.now(),this._boundLoop=this._loop.bind(this),this._boundLoop(),window.addEventListener(\"resize\",this._resize.bind(this))}return o(e,[{key:\"appendTo\",value:function(e){e.appendChild(this._element),this._resize()}},{key:\"add\",value:function(e){this._scene.add(e)}},{key:\"keyDown\",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=n?\"ai\"+e:e;if(this._currentNotes.hasOwnProperty(o)||(this._currentNotes[o]=[]),e&&t){var l=1e4,u=new i.Mesh(a,n?s:r),c=4,d=t.width-2*c;u.scale.set(d,l,1),u.position.z=0,u.position.x=t.left+c+d/2,u.position.y=this._element.clientHeight+this._camera.position.y+l/2,this._scene.add(u),this._currentNotes[o].push({plane:u,position:this._camera.position.y})}}},{key:\"keyUp\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?\"ai\"+e:e;if(this._currentNotes[n]&&this._currentNotes[n].length){var o=this._currentNotes[n].shift(),i=o.plane,a=o.position;i.scale.y=Math.max(this._camera.position.y-a,5),i.position.y=this._element.clientHeight+a+i.scale.y/2}}},{key:\"_resize\",value:function(){this._element.clientWidth,this._element.clientHeight;this._camera.left=0,this._camera.bottom=this._element.clientHeight,this._camera.right=this._element.clientWidth,this._camera.top=0,this._camera.updateProjectionMatrix(),this._renderer.setSize(this._element.clientWidth,this._element.clientHeight)}},{key:\"_loop\",value:function(){var e=Date.now()-this._lastUpdate;this._lastUpdate=Date.now(),requestAnimationFrame(this._boundLoop),this._renderer.render(this._scene,this._camera),this._camera.position.y+=.1*e}},{key:\"bottom\",get:function(){return this._element.clientHeight+this._camera.position.y}}]),e}());t.Roll=l},128:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.About=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.funcion=function(){return s},n(188);var i,a=n(50),r=(i=a)&&i.__esModule?i:{default:i};var s;t.About=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=0,o=4,i=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(i._container=document.createElement(\"div\"),i._container.id=\"about\",e.appendChild(i._container),i._divImportar=document.createElement(\"div\"),i._divImportar.id=\"divImportar\",i._divImportar.innerHTML='\\n\\t\\t<div class=\"divContenido\">\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t<div id=\"FileDrop\">\\t\\t\\t\\n\\t\\t\\t\\t<div id=\"Text\">\\t\\t\\t\\t\\n\\t\\t\\t\\t\\tArrastre archivo midi aqu√≠\\t\\n\\t\\t\\t\\t</div>\\t\\t\\t\\n\\t\\t\\t\\t<input type=\"file\" accept=\"audio/midi\">\\t\\t\\n\\t\\t\\t</div>\\t\\t\\n\\t\\t\\t<div id=\"Results\">\\t\\t\\t\\n\\t\\t\\t\\t<textarea id=\"ResultsText\" style=\"width:0px;height:0px;visibility: hidden;\" placeholder=\"json output...\"></textarea>\\t\\t\\n\\t\\t\\t</div>\\t\\t\\n\\t\\t\\t<tone-play-toggle disabled></tone-play-toggle>\\t\\n\\n\\t\\t</div>',i._divImportar.classList.add(\"open\"),e.appendChild(i._divImportar),window.File&&window.FileReader&&window.FileList&&window.Blob){var a=document.querySelector(\"#FileDrop\");a.addEventListener(\"dragenter\",(function(){return a.classList.add(\"Hover\")})),a.addEventListener(\"dragleave\",(function(){return a.classList.remove(\"Hover\")})),a.addEventListener(\"drop\",(function(){return a.classList.remove(\"Hover\")})),document.querySelector(\"#FileDrop input\").addEventListener(\"change\",(function(e){var t=e.target.files;if(t.length>0){var n=t[0];document.querySelector(\"#FileDrop #Text\").textContent=n.name,function(e){var t=new FileReader;t.onload=function(e){var t=new Midi(e.target.result);document.querySelector(\"#ResultsText\").value=JSON.stringify(t,void 0,2),document.querySelector(\"tone-play-toggle\").removeAttribute(\"disabled\"),s=r=t},t.readAsArrayBuffer(e)}(n)}}))}else document.querySelector(\"#FileDrop #Text\").textContent=\"Reading files not supported by this browser\";var r=null;var l=[];document.querySelector(\"tone-play-toggle\").addEventListener(\"play\",(function(e){if(e.detail&&r){var t=Tone.now()+.5;r.tracks.forEach((function(e){var n=new Tone.PolySynth(10,Tone.Synth,{envelope:{attack:.02,decay:.1,sustain:.3,release:1}}).toMaster();l.push(n),e.notes.forEach((function(e){n.triggerAttackRelease(e.name,e.duration,e.time+t,e.velocity)}))}))}else for(;l.length;){l.shift().dispose()}})),i._BotonMasOctava=document.createElement(\"div\"),i._BotonMasOctava.id=\"botonMasOctava\",i._BotonMasOctava.classList.add(\"open\"),e.appendChild(i._BotonMasOctava),i._BotonMasOctava.addEventListener(\"click\",(function(e){e.preventDefault(),i.isOpen()?i.close():(o++,o%=5,localStorage.setItem(\"octava\",o-2))})),i.cantidad=document.createElement(\"div\"),i.cantidad.id=\"cantidad\",i.cantidad.classList.add(\"open\"),e.appendChild(i.cantidad),i._BotonMas=document.createElement(\"div\"),i._BotonMas.id=\"botonMas\",i._BotonMas.classList.add(\"open\"),e.appendChild(i._BotonMas),i._BotonMas.addEventListener(\"click\",(function(e){e.preventDefault(),i.isOpen()?i.close():(n>=12?n=12:n++,i.cantidad.innerHTML=\"<p style='z-index: 5000;color:white;'>\"+n+\"</p>\")})),i._BotonMenos=document.createElement(\"div\"),i._BotonMenos.id=\"botonMenos\",i._BotonMenos.classList.add(\"open\"),e.appendChild(i._BotonMenos),i._BotonMenos.addEventListener(\"click\",(function(e){e.preventDefault(),i.isOpen()?i.close():(n<=-12?n=-12:n--,i.cantidad.innerHTML=\"<p style='z-index: 5000;color:white;'>\"+n+\"</p>\")})),i._toggleButton=document.createElement(\"div\"),i._toggleButton.id=\"aboutButton\",i._toggleButton.classList.add(\"open\"),e.appendChild(i._toggleButton),i._toggleButton.addEventListener(\"click\",(function(e){e.preventDefault(),i.isOpen()?i.close():i.open()}));var u=document.createElement(\"div\");u.id=\"content\",i._container.appendChild(u);var c=document.createElement(\"div\");c.id=\"title\",c.textContent=\"TIP Piano\";var d=document.createElement(\"div\");d.id=\"video\",d.innerHTML='<iframe id=\\'youtube-iframe\\' src=\"https://www.youtube.com/embed/0ZE1bfPtvZo?modestbranding=0&showinfo=0&enablejsapi=1\" frameborder=\"0\" allowfullscreen></iframe>',u.appendChild(d),i._ytplayer=null,i._playButton=document.createElement(\"div\"),i._playButton.id=\"playButton\",i._playButton.classList.add(\"visible\"),d.appendChild(i._playButton);var p=document.createElement(\"div\");return p.id=\"blurb\",u.appendChild(p),p.innerHTML=\"Built by Yotam Mann with friends on the Magenta and Creative Lab teams at Google. \\n\\t\\t\\t\\t\\tIt uses <a target='_blank' href='https://www.tensorflow.org/'>TensorFlow</a>,\\n\\t\\t\\t\\t\\t<a target='_blank' href='https://github.com/Tonejs/Tone.js'>Tone.js</a> and tools \\n\\t\\t\\t\\t\\tfrom the <a target='_blank' href='https://magenta.tensorflow.org/'>Magenta project</a>. \\n\\t\\t\\t\\t\\tThe open-source code is <a target='_blank' href='https://github.com/googlecreativelab/aiexperiments-ai-duet'>available here</a>.\\n\\t\\t\\t\\t\\tClick the keyboard, use your computer keys, or even plug in a MIDI keyboard.\",i}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:\"close\",value:function(){this._toggleButton.classList.remove(\"close\"),this._toggleButton.classList.add(\"open\"),this._container.classList.remove(\"visible\"),window.ga&&ga(\"send\",\"event\",\"AI-Duet\",\"Click\",\"About - Close\")}},{key:\"open\",value:function(){this.emit(\"open\")}},{key:\"_playVideo\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._ytplayer&&this._ytplayer.playVideo?this._ytplayer.playVideo():t<10&&this.isOpen()&&setTimeout((function(){return e._playVideo(t+1)}),200)}},{key:\"isOpen\",value:function(){return this._container.classList.contains(\"visible\")}},{key:\"showButton\",value:function(){this._toggleButton.classList.add(\"show\"),this._BotonMas.classList.add(\"show\"),this._BotonMasOctava.classList.add(\"show\"),this._BotonMenos.classList.add(\"show\"),this.cantidad.classList.add(\"show\"),this._divImportar.classList.add(\"show\")}}]),t}(r.default.EventEmitter)},175:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Keyboard=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=c(n(176)),a=c(n(17)),r=c(n(50)),s=n(177),l=c(n(183)),u=n(184);c(n(65));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n._container=e,n._active=!1;var o=0;localStorage.setItem(\"octava\",0),n._keyboard=new i.default({polyphony:88,rows:1,octaveControls:!1}),n._keyboard.down((function(e){o=localStorage.getItem(\"octava\");var t=a.default.Frequency(e.note,\"midi\").toNote(),i=a.default.Frequency(t).transpose(12*o).toNote(),r=a.default.Frequency(i).toMidi();n.keyDown(r),n._emitKeyDown(r)})),n._keyboard.up((function(e){var t=a.default.Frequency(e.note,\"midi\").toNote(),i=a.default.Frequency(t).transpose(12*o).toNote(),r=a.default.Frequency(i).toMidi();n.keyUp(r),n._emitKeyUp(r)})),n._keyboardInterface=new s.KeyboardElement(e,48,2),n._keyboardInterface.on(\"keyDown\",(function(e){o=localStorage.getItem(\"octava\");var t=a.default.Frequency(e,\"midi\").toNote(),i=a.default.Frequency(t).transpose(12*o).toNote(),r=a.default.Frequency(i).toMidi();n.keyDown(r),n._emitKeyDown(r)})),n._keyboardInterface.on(\"keyUp\",(function(e){var t=a.default.Frequency(e,\"midi\").toNote(),i=a.default.Frequency(t).transpose(12*o).toNote(),r=a.default.Frequency(i).toMidi();n.keyUp(r),n._emitKeyUp(r)})),window.addEventListener(\"resize\",n._resize.bind(n)),n._resize(),n._currentKeys={},n._eventQueue=new l.default.PriorityQueue((function(e,t){return t.time-e.time})),n._boundLoop=n._loop.bind(n),n._loop();var r=document.createElement(\"div\");return r.id=\"bottom\",e.appendChild(r),n._midi=new u.Midi,n._midi.on(\"keyDown\",(function(e){o=localStorage.getItem(\"octava\");var t=a.default.Frequency(e,\"midi\").toNote(),i=a.default.Frequency(t).transpose(12*o).toNote(),r=a.default.Frequency(i).toMidi();n.keyDown(r),n._emitKeyDown(e)})),n._midi.on(\"keyUp\",(function(e){var t=a.default.Frequency(e,\"midi\").toNote(),i=a.default.Frequency(t).transpose(12*o).toNote(),r=a.default.Frequency(i).toMidi();n.keyUp(r),n._emitKeyUp(e)})),n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:\"_loop\",value:function(){requestAnimationFrame(this._boundLoop);for(var e=a.default.now();!this._eventQueue.isEmpty()&&this._eventQueue.peek().time<=e;){this._eventQueue.dequeue().callback()}}},{key:\"_emitKeyDown\",value:function(e){this._active&&this.emit(\"keyDown\",e)}},{key:\"_emitKeyUp\",value:function(e){this._active&&this.emit(\"keyUp\",e)}},{key:\"keyDown\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.default.now(),n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._active&&(this._currentKeys[e]||(this._currentKeys[e]=0),this._currentKeys[e]+=1,this._eventQueue.add({time:t,callback:this._keyboardInterface.keyDown.bind(this._keyboardInterface,e,n)}))}},{key:\"keyUp\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.default.now(),n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._active&&(t+=.01,this._currentKeys[e]&&(this._currentKeys[e]-=1,this._eventQueue.add({time:t,callback:this._keyboardInterface.keyUp.bind(this._keyboardInterface,e,n)})))}},{key:\"_resize\",value:function(){var e=Math.round(window.innerWidth/24/12);e=Math.max(e,2);var t=48;(e=Math.min(e,7))>5&&(t-=12*(e-5)),this._keyboardInterface.resize(t,e)}},{key:\"activate\",value:function(){container.classList.add(\"focus\"),this._active=!0}},{key:\"deactivate\",value:function(){container.classList.remove(\"focus\"),this._active=!1}}]),t}(r.default.EventEmitter);t.Keyboard=d},176:function(e,t,n){\"use strict\";function o(e){this._setState(e),this._listeners={},this._bind()}e.exports=o,o.prototype._setState=function(e){e||(e={}),this._state={},this._extendState({polyphony:4,rows:1,priority:\"last\",rootNote:60,octaveControls:!0,octave:0,velocityControls:!0,velocity:127,keys:[],buffer:[]}),this._extendState(e)},o.prototype._extendState=function(e){for(var t in e)this._state[t]=e[t]},o.prototype.set=function(){var e=this;return 1===arguments.length?e._extendState(arguments[0]):e._state[arguments[0]]=arguments[1],this},o.prototype.get=function(e){return this._state[e]},o.prototype.down=function(e){this._listeners.down=(this._listeners.down||[]).concat(e)},o.prototype.up=function(e){this._listeners.up=(this._listeners.up||[]).concat(e)},o.prototype._trigger=function(e){var t=this;if(t._listeners[e]&&t._listeners[e].length){var n=Array.prototype.slice.call(arguments);n.splice(0,1),t._listeners[e].forEach((function(e){e.apply(t,n)}))}},o.prototype._bind=function(){var e=this;if(\"undefined\"!=typeof window&&window.document){window.document.addEventListener(\"keydown\",(function(t){e._addKey(t)})),window.document.addEventListener(\"keyup\",(function(t){e._removeKey(t)}));var t=!0;setInterval((function(){window.document.hasFocus()!==t&&((t=!t)||e.clear())}),100)}},o.prototype._map=function(e){return this._keyMap[this._state.rows][e]+this._offset()},o.prototype._offset=function(){return this._state.rootNote-this._keyMap[this._state.rows].root+12*this._state.octave},o.prototype._isNote=function(e){return!!this._keyMap[this._state.rows][e]},o.prototype._toFrequency=function(e){return 440*Math.pow(2,(e-69)/12)},o.prototype._keyMap={1:{root:60,65:60,87:61,83:62,69:63,68:64,70:65,84:66,71:67,89:68,72:69,85:70,74:71,75:72,79:73,76:74,80:75,186:76,222:77},2:{root:60,90:60,83:61,88:62,68:63,67:64,86:65,71:66,66:67,72:68,78:69,74:70,77:71,188:72,76:73,190:74,186:75,191:76,81:72,50:73,87:74,51:75,69:76,82:77,53:78,84:79,54:80,89:81,55:82,85:83,73:84,57:85,79:86,48:87,80:88,219:89,187:90,221:91}},o.prototype._addKey=function(e){if(this._isNote(e.keyCode)&&!this._isPressed(e.keyCode)){var t=this._makeNote(e.keyCode);this._state.keys=(this._state.keys||[]).concat(t),this._update()}else this._isSpecialKey(e.keyCode)&&this._specialKey(e.keyCode)},o.prototype._removeKey=function(e){if(this._isPressed(e.keyCode)){for(var t,n=0;n<this._state.keys.length;n++)if(this._state.keys[n].keyCode===e.keyCode){t=this._state.keys[n];break}this._state.keys.splice(this._state.keys.indexOf(t),1),this._update()}},o.prototype._isPressed=function(e){if(!this._state.keys||!this._state.keys.length)return!1;for(var t=0;t<this._state.keys.length;t++)if(this._state.keys[t].keyCode===e)return!0;return!1},o.prototype._makeNote=function(e){return{keyCode:e,note:this._map(e),frequency:this._toFrequency(this._map(e)),velocity:this._state.velocity}},o.prototype.clear=function(){var e=this;e._state.buffer.forEach((function(t){e._trigger(\"up\",t)})),e._state.keys=[],e._state.buffer=[]},o.prototype._update=function(){var e=this._state.buffer;this._prioritize(),this._diff(e)},o.prototype._diff=function(e){var t=this,n=e.map((function(e){return e.keyCode})),o=t._state.buffer.map((function(e){return e.keyCode})),i=[];n.forEach((function(e){-1===o.indexOf(e)&&i.push(e)}));var a=[];o.forEach((function(e){-1===n.indexOf(e)&&a.push(e)})),a.forEach((function(e){for(var n=0;n<t._state.buffer.length;n++)if(t._state.buffer[n].keyCode===e){t._trigger(\"down\",t._state.buffer[n]);break}})),i.forEach((function(n){for(var o=0;o<e.length;o++)if(e[o].keyCode===n){t._trigger(\"up\",e[o]);break}}))},o.prototype._prioritize=function(){var e=this;e._state.keys.length?(e._state.polyphony>=e._state.keys.length?e._state.keys=e._state.keys.map((function(e){return e.isActive=!0,e})):(e._state.keys=e._state.keys.map((function(e){return e.isActive=!1,e})),e[\"_\"+e._state.priority]()),e._state.buffer=[],e._state.keys.forEach((function(t){t.isActive&&e._state.buffer.push(t)}))):e._state.buffer=[]},o.prototype._last=function(){for(var e=this._state.keys.length-this._state.polyphony;e<this._state.keys.length;e++)this._state.keys[e].isActive=!0},o.prototype._first=function(){for(var e=0;e<this._state.polyphony;e++)this._state.keys[e].isActive=!0},o.prototype._highest=function(){var e=this._state.keys.map((function(e){return e.note}));e.sort((function(e,t){return t===e?0:t<e?-1:1})),e.splice(this._state.polyphony,Number.MAX_VALUE),this._state.keys.forEach((function(t){-1!==e.indexOf(t.note)&&(t.isActive=!0)}))},o.prototype._lowest=function(){var e=this._state.keys.map((function(e){return e.note}));e.sort((function(e,t){return e===t?0:e<t?-1:1})),e.splice(this._state.polyphony,Number.MAX_VALUE),this._state.keys.forEach((function(t){-1!==e.indexOf(t.note)&&(t.isActive=!0)}))},o.prototype._isSpecialKey=function(e){return 1===this._state.rows&&this._specialKeyMap[e]},o.prototype._specialKey=function(e){\"octave\"===this._specialKeyMap[e].type&&this._state.octaveControls?this._state.octave+=this._specialKeyMap[e].value:\"velocity\"===this._specialKeyMap[e].type&&this._state.velocityControls&&(this._state.velocity=this._specialKeyMap[e].value)},o.prototype._specialKeyMap={90:{type:\"octave\",value:-1},88:{type:\"octave\",value:1},49:{type:\"velocity\",value:1},50:{type:\"velocity\",value:14},51:{type:\"velocity\",value:28},52:{type:\"velocity\",value:42},53:{type:\"velocity\",value:56},54:{type:\"velocity\",value:70},55:{type:\"velocity\",value:84},56:{type:\"velocity\",value:98},57:{type:\"velocity\",value:112},48:{type:\"velocity\",value:127}}},177:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.KeyboardElement=void 0;var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(50),r=(o=a)&&o.__esModule?o:{default:o};n(178),n(180);var s=n(124),l=n(181);function u(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function c(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var d=[0,.5,1,1.5,2,3,3.5,4,4.5,5,5.5,6],p=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:36,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;u(this,t);var i=c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i._container=document.createElement(\"div\"),i._container.id=\"keyboard\",e.setAttribute(\"touch-action\",\"none\"),e.appendChild(i._container),e.addEventListener(\"pointerup\",(function(e){return delete i._pointersDown[e.pointerId]})),e.addEventListener(\"contextmenu\",i._absorbEvent.bind(i)),i._keys={},i._pointersDown={},i.resize(n,o),s.Roll.appendTo(e),i._aiNotes={},i._notes={},i}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:\"resize\",value:function(e,t){this._keys={},this._container.innerHTML=\"\";for(var n=1/7/t,o=e;o<e+12*t;o++){var i=document.createElement(\"div\");i.classList.add(\"key\");var a=-1!==[1,3,6,8,10].indexOf(o%12);i.classList.add(a?\"black\":\"white\"),this._container.appendChild(i);var r=Math.floor(o/12)-Math.floor(e/12),s=d[o%12]+7*r;i.style.width=100*n+\"%\",i.style.left=s*n*100+\"%\",i.id=o.toString(),i.setAttribute(\"touch-action\",\"none\");var l=document.createElement(\"div\");l.id=\"fill\",i.appendChild(l),this._bindKeyEvents(i),this._keys[o]=i}}},{key:\"_absorbEvent\",value:function(e){var t=e||window.event;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}},{key:\"_bindKeyEvents\",value:function(e){var t=this;e.addEventListener(\"pointerover\",(function(n){if(t._pointersDown[n.pointerId]){var o=parseInt(n.target.id);t.emit(\"keyDown\",o)}else e.classList.add(\"hover\")})),e.addEventListener(\"pointerout\",(function(n){if(t._pointersDown[n.pointerId]){var o=parseInt(n.target.id);t.emit(\"keyUp\",o)}else e.classList.remove(\"hover\")})),e.addEventListener(\"pointerdown\",(function(e){var n=parseInt(e.target.id);t.emit(\"keyDown\",n),t._pointersDown[e.pointerId]=!0})),e.addEventListener(\"pointerup\",(function(e){var n=parseInt(e.target.id);t.emit(\"keyUp\",n),delete t._pointersDown[e.pointerId]})),e.addEventListener(\"touchstart\",this._absorbEvent.bind(this)),e.addEventListener(\"touchend\",this._absorbEvent.bind(this)),e.addEventListener(\"touchmove\",this._absorbEvent.bind(this)),e.addEventListener(\"touchcancel\",this._absorbEvent.bind(this))}},{key:\"keyDown\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._keys.hasOwnProperty(e)){var n=this._keys[e];n.classList.remove(\"hover\");var o=new l.Note(n.querySelector(\"#fill\"),t),i=t?this._aiNotes:this._notes;i[e]||(i[e]=[]),i[e].push(o)}}},{key:\"keyUp\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._keys.hasOwnProperty(e)){var n=t?this._aiNotes:this._notes;n[e]&&n[e].length?n[e].shift().noteOff():console.warn(\"note off before note on\")}}}]),t}(r.default.EventEmitter);t.KeyboardElement=p},178:function(e,t,n){var o=n(179);\"string\"==typeof o&&(o=[[e.i,o,\"\"]]);n(1)(o,{});o.locals&&(e.exports=o.locals)},179:function(e,t,n){(e.exports=n(0)()).push([e.i,\"#keyboard{width:calc(100% - 2 * 2px);cursor:pointer}#keyboard,#keyboard .key{position:absolute;user-select:none}#keyboard .key{height:calc(100% - 2 * 2px);width:10px;left:0;top:0}#keyboard .key.black{z-index:1;height:50%}#keyboard .key.black #fill{background-color:#000;width:calc(100% - 8px);left:4px}#keyboard .key.white{z-index:0}#keyboard .key.white #fill{background-color:#222}#keyboard .key.black.hover #fill,#keyboard .key.white.hover #fill{border-color:#fff;background-color:#aaa}#keyboard .key #fill{border:2px solid #d7d7d7}#keyboard .key #fill,#keyboard .key .highlight{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}#keyboard .key .highlight{background-color:#1eb7eb;opacity:0;transition:opacity .6s}#keyboard .key .highlight.active{opacity:1}#keyboard .key .highlight.ai{background-color:#f9bb2d}\",\"\"])},181:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Note=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(182);t.Note=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.element=document.createElement(\"div\"),this.element.classList.add(\"highlight\"),this.element.classList.add(\"active\"),n&&this.element.classList.add(\"ai\"),t.appendChild(this.element),this.rollNote=new i.RollNote(t,n)}return o(e,[{key:\"noteOff\",value:function(){var e=this;this.element.classList.remove(\"active\"),this.rollNote.noteOff(),setTimeout((function(){e.element.remove()}),1e3)}}]),e}()},182:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.RollNote=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(124);var a=n(125),r=new a.PlaneBufferGeometry(1,1,1),s=new a.MeshBasicMaterial({color:2078700,side:a.BackSide}),l=new a.MeshBasicMaterial({color:16758569,side:a.BackSide});t.RollNote=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.element=t;var o=this.element.getBoundingClientRect();this.plane=new a.Mesh(r,n?l:s);var u=o.width-8;this.plane.scale.set(u,3e3,1),this.plane.position.z=0,this.plane.position.x=o.left+4+u/2,this.plane.position.y=i.Roll.bottom+1500,this.bottom=i.Roll.bottom,i.Roll.add(this.plane)}return o(e,[{key:\"noteOff\",value:function(e){var t=i.Roll.bottom-this.bottom;this.plane.scale.y=Math.max(t,5),this.plane.position.y=this.bottom+this.plane.scale.y/2}}]),e}()},184:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Midi=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=r(n(50)),a=r(n(185));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._isEnabled=!1,a.default.enable((function(t){t||(e._isEnabled=!0,a.default.inputs&&a.default.inputs.forEach((function(t){return e._bindInput(t)})),a.default.addListener(\"connected\",(function(t){t.input&&e._bindInput(t.input)})))})),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:\"_bindInput\",value:function(e){var t=this;this._isEnabled&&(a.default.addListener(\"disconnected\",(function(e){e.input&&(e.input.removeListener(\"noteOn\"),e.input.removeListener(\"noteOff\"))})),e.addListener(\"noteon\",\"all\",(function(e){try{t.emit(\"keyDown\",e.note.number)}catch(e){console.warn(e)}})),e.addListener(\"noteoff\",\"all\",(function(e){try{t.emit(\"keyUp\",e.note.number)}catch(e){console.warn(e)}})))}}]),t}(i.default.EventEmitter);t.Midi=s},187:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.AI=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=s(n(17)),a=s(n(50)),r=n(128);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.init(),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:\"init\",value:function(){this.guardarNotas,this.guardarMidi,this._newTrack(),this._sendTimeout=-1,this._heldNotes={},this._lastPhrase=-1,this._firstPhrase=-1,this._aiEndTime=0}},{key:\"_newTrack\",value:function(){this._midi=new MidiConvert.create,this._track=this._midi.track()}},{key:\"send\",value:function(){var e=this,t=document.getElementById(\"cantidad\").textContent;if(null==(0,r.funcion)()){if(this._track.length||void 0!==this.guardarNotas){this._track.length?(this.guardarMidi=null,this.guardarNotas=null,this.guardarNotas=this._track,this.guardarMidi=this._midi):(this.init(),this._newTrack(),this._track=null,this._track=this.guardarNotas,this._midi=this.guardarMidi),this._track.notes.forEach((function(n){var o=i.default.now()+.05;if(n.noteOn+o>e._aiEndTime){var a=i.default.Frequency(n.midi,\"midi\").toNote(),r=i.default.Frequency(a).transpose(t).toNote(),s=i.default.Frequency(r).toMidi();e._aiEndTime=n.noteOn+o,e.emit(\"keyDown\",s,n.noteOn+(o-e._firstPhrase)),console.log(\"--------------------------\"),console.log(\"note.noteOn = \"+n.noteOn),console.log(\"now = \"+o),console.log(\"this._firstPhrase = \"+e._firstPhrase),n.duration=.9*n.duration,n.duration=Math.min(n.duration,4),e.emit(\"keyUp\",s,n.noteOff+(o-e._firstPhrase))}}));var n=this._midi.slice(this._midi.startTime);this._newTrack();var o=n.duration;o>10&&(o=(n=n.slice(n.duration-15)).duration);var a=o;a=Math.min(a,8),a=Math.max(a,1),this._lastPhrase=-1,this.emit(\"sent\")}}else this.tocarMidi()}},{key:\"keyDown\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.default.now();0===this._track.length&&(this._lastPhrase=Date.now(),this._firstPhrase=i.default.now(),this._newTrack()),this._track.noteOn(e,t),clearTimeout(this._sendTimeout),this._heldNotes[e]=!0}},{key:\"keyUp\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.default.now();this._track.noteOff(e,t),delete this._heldNotes[e],0===Object.keys(this._heldNotes).length&&-1!==this._lastPhrase&&(Date.now(),this._lastPhrase)}},{key:\"tocarMidi\",value:function(){var e=this,t=0,n=null;null!=(n=(0,r.funcion)())?n.tracks.forEach((function(n){console.log(\"UN TRACK\"),t<5&&(e.init(),e._newTrack(),e._track=null,e._track=n,e._track.notes.forEach((function(t){e.tocarNota(t)})),t++)})):alert(\"midi es null\")}},{key:\"tocarNota\",value:function(e){var t=document.getElementById(\"cantidad\").textContent,n=i.default.now()+.05,o=i.default.Frequency(e.midi,\"midi\").toNote(),a=i.default.Frequency(o).transpose(t).toNote(),r=i.default.Frequency(a).toMidi();this._aiEndTime=e.noteOn+n,this.emit(\"keyDown\",r,n+e.time),this.emit(\"keyUp\",r,n+e.time+e.duration)}}]),t}(a.default.EventEmitter);t.AI=l},188:function(e,t,n){var o=n(189);\"string\"==typeof o&&(o=[[e.i,o,\"\"]]);n(1)(o,{});o.locals&&(e.exports=o.locals)},189:function(e,t,n){(e.exports=n(0)()).push([e.i,'#divImportar{position:absolute;top:0;left:120px;cursor:pointer;z-index:1000;transition:transform .1s;text-align:center}#divImportar.show.open:before{display:inline-block}#cantidad{position:absolute;top:15px;right:60px;width:60px;height:40px;cursor:pointer;z-index:1000;transition:transform .1s;text-align:center}#cantidad.show.open:before{background-color:blue;display:inline-block}#botonMasOctava{position:absolute;top:15px;left:15px;width:80px;height:40px;cursor:pointer;z-index:2000;transition:transform .1s;text-align:center}#botonMasOctava:hover{transform:scale(1.1)}#botonMasOctava:before{font-family:Quicksand,sans-serif;font-weight:700;width:100%;height:100%;position:absolute;top:0;right:0;line-height:40px}#botonMasOctava.open:before{content:\"Octava\";background-color:#e3ad0b;display:none}#botonMasOctava.show.open:before{display:inline-block}#botonMas{position:absolute;top:15px;right:15px;width:40px;height:40px;cursor:pointer;z-index:2000;transition:transform .1s;text-align:center}#botonMas:hover{transform:scale(1.1)}#botonMas:before{font-family:Quicksand,sans-serif;font-weight:700;width:100%;height:100%;position:absolute;top:0;right:0;line-height:40px}#botonMas.open:before{content:\"+\";background-color:#e3ad0b;border-radius:50%;display:none}#botonMas.show.open:before{display:inline-block}#botonMenos{position:absolute;top:15px;right:125px;width:40px;height:40px;cursor:pointer;z-index:2000;transition:transform .1s;text-align:center}#botonMenos:hover{transform:scale(1.1)}#botonMenos:before{font-family:Quicksand,sans-serif;font-weight:700;width:100%;height:100%;position:absolute;top:0;right:0;line-height:40px}#botonMenos.open:before{content:\"-\";background-color:#e3ad0b;border-radius:50%;display:none}#botonMenos.show.open:before{display:inline-block}#aboutButton{position:absolute;top:15px;right:185px;width:100px;height:40px;cursor:pointer;z-index:1000;transition:transform .1s;text-align:center}#aboutButton:hover{transform:scale(1.1)}#aboutButton:before{font-family:Quicksand,sans-serif;font-weight:700;width:100%;height:100%;position:absolute;top:0;right:0;line-height:40px}#aboutButton.open:before{content:\"Transportar\";background-color:#0aaefa;display:none}#aboutButton.show.open:before{display:inline-block}#about{width:100%;height:100%;z-index:10;top:0;left:0;position:absolute;overflow-y:auto;display:none}#about.visible{display:initial}#about #content{width:90%;min-width:300px;max-width:800px;height:auto;color:#fff}#about #content,#about #content #title{font-family:Quicksand,sans-serif;position:relative}#about #content #title{font-size:40px;line-height:30px}#about #content #video{top:30px;width:100%;cursor:pointer;position:relative}@media (max-width:450px){#about #content #video{height:200px}}@media (min-width:450px) and (max-width:700px){#about #content #video{height:380px}}@media (min-width:700px){#about #content #video{height:450px}}#about #content #video iframe{width:100%;height:100%}#about #content #video #playButton{pointer-events:none;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100px;height:100px;background-image:url('+n(190)+\");background-size:100% 100%;display:none}#about #content #video #playButton.visible{display:initial}#about #content #video:hover #playButton svg{fill:blue}#about #content #blurb{position:relative;text-transform:none;margin-top:50px;font-size:14px;line-height:25px}#about #content #blurb a{color:#f9bb2d}#FileDrop{position:relative;width:100%;height:50px;border:2px dashed #000;color:#000;margin:0}#FileDrop.Hover{background-color:#000;color:#0aaefa}#FileDrop input{height:100%;opacity:0;top:0}#FileDrop #Text,#FileDrop input{position:absolute;width:100%;left:0}#FileDrop #Text{height:20px;line-height:20px;top:50%;transform:translateY(-50%);text-align:center}textarea{font-family:monospace;height:300px;display:inline-block;float:left}#Results,textarea{width:100%;position:relative}#Results{margin:10px auto}.divContenido{margin-top:17px;width:200px}tone-play-toggle{width:10px;position:absolute;right:-100px;top:5px;margin-top:10px}\",\"\"])},190:function(e,t){e.exports=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9Ii0zMzUgNjY1IDE4MCAxODAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgLTMzNSA2NjUgMTgwIDE4MCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8cGF0aCBkPSJNLTI0NSw2NjljLTQ3LjUsMC04NiwzOC41LTg2LDg2czM4LjUsODYsODYsODZzODYtMzguNSw4Ni04NlMtMTk3LjUsNjY5LTI0NSw2Njl6Ii8+DQo8Zz4NCgk8Zz4NCgkJPGc+DQoJCQk8cGF0aCBmaWxsPSIjRkZGRkZGIiBkPSJNLTI2MS45LDcyMC45Yy0wLjUtMC4zLTAuOC0wLjEtMC44LDAuNHY2Ny4yYzAsMC41LDAuNCwwLjcsMC44LDAuNGw0OS45LTMzLjVjMC41LTAuMywwLjUtMC44LDAtMS4xDQoJCQkJTC0yNjEuOSw3MjAuOXoiLz4NCgkJPC9nPg0KCQk8Zz4NCgkJCTxwYXRoIGZpbGw9IiNGRkZGRkYiIGQ9Ik0tMjYyLjgsNzg5LjZ2LTY5LjIiLz4NCgkJPC9nPg0KCTwvZz4NCjwvZz4NCjwvc3ZnPg0K\"},191:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Sound=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=r(n(17)),a=(r(n(192)),r(n(77)),r(n(205)),n(211));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),screen.availWidth<750&&screen.availHeight<750?this._range=[48,72]:screen.availWidth<1e3&&screen.availHeight<1e3?this._range=[48,84]:this._range=[24,108],this._piano=new a.Sampler(\"audio/Salamander/\",this._range),this._synth=new a.Sampler(\"audio/string_ensemble/\",this._range)}return o(e,[{key:\"load\",value:function(){return Promise.all([this._piano.load(),this._synth.load()])}},{key:\"keyDown\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.default.now(),n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e>=this._range[0]&&e<=this._range[1]&&(this._piano.keyDown(e,t),n&&(this._synth.volume=-8,this._synth.keyDown(e,t)))}},{key:\"keyUp\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.default.now(),n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e>=this._range[0]&&e<=this._range[1]&&(t+=.05,this._piano.keyUp(e,t),n&&this._synth.keyUp(e,t))}}]),e}();t.Sound=s},211:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Sampler=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=s(n(77)),a=(s(n(137)),s(n(212))),r=(s(n(17)),s(n(65)));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}var u=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[21,108];l(this,e);var a=[21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108],s=a.findIndex((function(e){return e>=o[0]})),u=a.findIndex((function(e){return e>=o[1]}));u=-1===u?u=a.length:u+1;var c=a.slice(s,u);this._urls={},c.forEach((function(e){t._urls[e-1]=n+(0,i.default)(e,\"midi\").toNote().replace(\"#\",\"s\")+\".mp3\",t._urls[e]=n+(0,i.default)(e,\"midi\").toNote().replace(\"#\",\"s\")+\".mp3\",t._urls[e+1]=n+(0,i.default)(e,\"midi\").toNote().replace(\"#\",\"s\")+\".mp3\"})),this._player=null,this._loaded=!1,r.default.on(\"load\",(function(){t._loaded=!0}))}return o(e,[{key:\"load\",value:function(){var e=this;return new Promise((function(t){e._player=new a.default(e._urls,t).toMaster(),e._player.fadeOut=.2}))}},{key:\"keyDown\",value:function(e,t){if(this._loaded){var n=this._midiToFrequencyPitch(e),o=.95*this._player.buffers.get(e).duration;this._player.start(e,t,0,o-this._player.fadeOut,n)}}},{key:\"keyUp\",value:function(e,t){this._loaded&&this._player.stop(e,t)}},{key:\"_midiToFrequencyPitch\",value:function(e){var t=e%3;return 1===t?1:2===t?-1:0}},{key:\"volume\",set:function(e){this._loaded&&(this._player.volume.value=e)}}]),e}();t.Sampler=u},214:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Glow=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();n(215);var i,a=n(17),r=(i=a)&&i.__esModule?i:{default:i};var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this._element=document.createElement(\"div\"),this._element.id=\"glow\",t.appendChild(this._element),this._aiGlow=document.createElement(\"div\"),this._aiGlow.id=\"ai\",this._element.appendChild(this._aiGlow),this._userGlow=document.createElement(\"div\"),this._userGlow.id=\"user\",this._element.appendChild(this._userGlow),this._aiTime=-1,this._boundLoop=this._loop.bind(this),this._loop(),this._aiVisible=!0}return o(e,[{key:\"_loop\",value:function(){requestAnimationFrame(this._boundLoop),this._aiTime<0||r.default.now()>this._aiTime?this._aiVisible&&(this._aiVisible=!1,this._aiGlow.classList.remove(\"visible\"),this._userGlow.classList.add(\"visible\")):this._aiVisible||(this._aiVisible=!0,this._aiGlow.classList.add(\"visible\"),this._userGlow.classList.remove(\"visible\"))}},{key:\"ai\",value:function(e){this._aiTime=Math.max(this._aiTime,e+.3)}},{key:\"user\",value:function(){this._aiTime=-1}}]),e}();t.Glow=s},215:function(e,t,n){var o=n(216);\"string\"==typeof o&&(o=[[e.i,o,\"\"]]);n(1)(o,{});o.locals&&(e.exports=o.locals)},216:function(e,t,n){(e.exports=n(0)()).push([e.i,\"#glow{background-color:gray;background-image:repeating-linear-gradient(45deg,transparent,transparent 35px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 70px);animation:example 5s infinite}#glow #ai,#glow #user{width:100%;height:100%;position:absolute;top:0;left:0;transition:opacity 1.2s}#glow #ai.visible,#glow #user.visible{opacity:.3}#glow #ai{opacity:0;background:linear-gradient(0deg,rgba(255,0,0,0),rgba(255,0,0,0),orange)}#glow #user{opacity:0;background:linear-gradient(0deg,blue,rgba(255,0,0,0),rgba(255,0,0,0));width:100%;height:100%;position:relative}\",\"\"])},217:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Splash=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();r(n(65));n(3);var i=r(n(50)),a=r(n(218));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=n._splash=document.createElement(\"div\");o.id=\"splash\",e.appendChild(o);var i=document.createElement(\"div\");i.id=\"titleContainer\",o.appendChild(i);var r=document.createElement(\"div\");r.id=\"title\",r.textContent=\"TIP Piano\",i.appendChild(r);var s=document.createElement(\"div\");s.id=\"subTitle\",i.appendChild(s),s.textContent=\"Un piano que te responde.\",n._clicked=!1,(n._loader=new a.default(i)).on(\"click\",(function(){o.classList.add(\"disappear\"),n._clicked=!0,n.emit(\"click\")}));var l=document.createElement(\"div\");l.id=\"badges\",o.appendChild(l);var u=document.createElement(\"a\");u.href=\"https://www.fing.edu.uy/tecnoinf/paysandu/index.html\",u.target=\"_blank\",u.id=\"magentaLink\",u.classList.add(\"badge\");u.innerHTML='<div id=\"img\"></div><div id=\"text\">Tecn√≥logo en Inform√°tica</div>',l.appendChild(u);var c=document.createElement(\"div\");c.classList.add(\"badgeBreak\"),l.appendChild(c);var d=document.createElement(\"a\");d.href=\"https://utec.edu.uy/\",d.target=\"_blank\",d.id=\"magentaLink\",d.classList.add(\"badge\");return d.innerHTML='<div id=\"imgUtec\"></div><div id=\"text\"></div>',l.appendChild(d),n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:\"isOpen\",value:function(){return!this._clicked}},{key:\"show\",value:function(){this._splash.classList.remove(\"disappear\")}},{key:\"hide\",value:function(){this._splash.classList.add(\"disappear\")}},{key:\"loaded\",get:function(){return this._loader.loaded}}]),t}(i.default.EventEmitter);t.Splash=s},218:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var o=s(n(65)),i=s(n(17)),a=s(n(50)),r=s(n(219));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=document.createElement(\"div\");a.id=\"loader\",e.appendChild(a);var s=document.createElement(\"div\");s.id=\"loaderText\",s.textContent=\"cargando\",a.appendChild(s);var l=document.createElement(\"div\");l.id=\"fill\",a.appendChild(l);var u=document.createElement(\"div\");return u.id=\"fillText\",u.textContent=\"cargando\",l.appendChild(u),(0,r.default)(i.default.context,a),n.loaded=!1,o.default.on(\"load\",(function(){n.loaded=!0,u.innerHTML='<div id=\"piano\"></div> <div id=\"\"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOCAR</div>',a.classList.add(\"clickable\"),a.addEventListener(\"click\",(function(){n.emit(\"click\")}))})),o.default.on(\"progress\",(function(e){l.style.width=(100*e).toFixed(2)+\"%\"})),n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default.EventEmitter);t.default=l},220:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Tutorial=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=r(n(50)),a=r(n(17));function r(e){return e&&e.__esModule?e:{default:e}}n(221);var s=[{note:60,time:0,duration:.4},{note:62,time:.4,duration:.4},{note:64,time:.8,duration:.4},{note:64,time:.4*3,duration:.2},{note:62,time:.4*3.6,duration:.2},{note:60,time:1.6,duration:.2},{note:60,time:2,duration:.4}];t.Tutorial=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._tutorial=document.createElement(\"div\"),n._tutorial.id=\"tutorial\",e.appendChild(n._tutorial),n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:\"start\",value:function(){var e=this;if(window.localStorage){if(\"true\"===window.localStorage.getItem(\"showedTutorial\")&&\"#tutorial\"!==window.location.hash)return;window.localStorage.setItem(\"showedTutorial\",\"true\")}this._promiseTimeout(400).then((function(){return e._addText(\"When you play a few notes\",\"user\",4200),e._promiseTimeout(1e3)})).then((function(){var t=a.default.now();return s.forEach((function(n){e.emit(\"keyDown\",n.note,n.time+t),e.emit(\"keyUp\",n.note,n.time+.9*n.duration+t)})),e._promiseTimeout(3e3)})).then((function(){return e._sendUserMelody(),e._promiseTimeout(500)})).then((function(){e._addText(\"the computer will respond to what you play\",\"ai\",5e3)}))}},{key:\"_promiseTimeout\",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:\"_sendUserMelody\",value:function(){var e=this,t=a.default.now();s.forEach((function(n){e.emit(\"aiKeyDown\",n.note,n.time+t),e.emit(\"aiKeyUp\",n.note,n.time+.9*n.duration+t)}))}},{key:\"_addText\",value:function(e,t,n){var o=this,i=document.createElement(\"div\");return i.classList.add(\"text\"),i.classList.add(t),i.textContent=e,this._tutorial.appendChild(i),requestAnimationFrame((function(){i.classList.add(\"visible\")})),n&&setTimeout((function(){o._removeText(i)}),n),i}},{key:\"_removeText\",value:function(e){e.classList.remove(\"visible\"),setTimeout((function(){e.remove()}),500)}}]),t}(i.default.EventEmitter)},221:function(e,t,n){var o=n(222);\"string\"==typeof o&&(o=[[e.i,o,\"\"]]);n(1)(o,{});o.locals&&(e.exports=o.locals)},222:function(e,t,n){(e.exports=n(0)()).push([e.i,\"#tutorial{top:50%;left:50%;height:50px;width:80%;min-width:300px;transform:translate(-50%,-50%);color:#fff;font-family:Quicksand,sans-serif;text-align:center;font-size:20px;opacity:1}#tutorial,#tutorial .text{position:absolute;transition:opacity .3s}#tutorial .text{top:0;left:0;width:100%;height:100%;opacity:0}#tutorial .text.visible{opacity:1}#tutorial.disappear{opacity:0}\",\"\"])},4:function(e,t,n){\"use strict\";var o=n(175),i=n(187),a=n(191),r=n(214),s=n(217),l=n(128),u=n(220);n(223);var c=d(n(17));d(n(77));function d(e){return e&&e.__esModule?e:{default:e}}var p=new l.About(document.body),f=new s.Splash(document.body);f.on(\"click\",(function(){v.activate(),p.showButton()})),f.on(\"about\",(function(){p.open(!0)})),p.on(\"close\",(function(){!f.loaded||f.isOpen()?f.show():v.activate()})),p.on(\"open\",(function(){b.send()}));var h=document.createElement(\"div\");h.id=\"container\",document.body.appendChild(h);var y=new r.Glow(h),v=new o.Keyboard(h),_=new a.Sound;_.load(),v.on(\"keyDown\",(function(e){var t=c.default.Frequency(e,\"midi\").toNote(),n=c.default.Frequency(t).transpose(12).toNote();c.default.Frequency(n).toMidi();_.keyDown(e),b.keyDown(e),y.user()})),v.on(\"keyUp\",(function(e){_.keyUp(e),b.keyUp(e),y.user()}));var b=new i.AI;b.on(\"keyDown\",(function(e,t){console.log(\"keyDownai - \"+e+\" - \"+t),_.keyDown(e,t,!0),v.keyDown(e,t,!0),y.ai(t)})),b.on(\"keyUp\",(function(e,t){console.log(\"keyUpai- \"+e+\" - \"+t),_.keyUp(e,t,!0),v.keyUp(e,t,!0),y.ai(t)}));var m=new u.Tutorial(h);m.on(\"keyDown\",(function(e,t){console.log(\"keyDownT\"),_.keyDown(e,t),v.keyDown(e,t),y.user()})),m.on(\"keyUp\",(function(e,t){console.log(\"keyUpT\"),_.keyUp(e,t),v.keyUp(e,t),y.user()})),m.on(\"aiKeyDown\",(function(e,t){b.keyDown(e,t)})),m.on(\"aiKeyUp\",(function(e,t){b.keyUp(e,t)}))},425:function(e,t,n){(e.exports=n(0)()).push([e.i,\"#notsupported{position:absolute;top:50%;left:50%;text-align:center;color:#fff;margin-left:-110px;width:220px;height:100px;margin-top:-50px;font-family:Quicksand,sans-serif;font-size:20px}#notsupported a{color:#fff}\",\"\"])},5:function(e,t,n){var o=n(425);\"string\"==typeof o&&(o=[[e.i,o,\"\"]]);n(1)(o,{});o.locals&&(e.exports=o.locals)}}]);","extractedComments":[]}